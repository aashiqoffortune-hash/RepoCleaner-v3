# RepoCleaner v3

> **Strip embedded tool references from code exports in seconds.** Remove Lovable badges, watermarks, and metadata automatically while preserving your code integrity.

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

## üéØ What It Does

RepoCleaner scans your project for traces of code generation tools (like Lovable, Vercel, etc.) and removes them safely:

- **Detects & Removes**: Watermarks, badges, comments, metadata, and tool-specific references
- **Preserves Code**: Maintains all functional code while cleaning only cosmetic traces
- **Zero Dependencies**: Uses Python stdlib only‚Äîno installation overhead
- **Production Ready**: Handles monorepos with 40K+ files in minutes

### Supported File Types
HTML, JavaScript, TypeScript, JSX, TSX, CSS, Markdown, JSON, SVG, YAML, TOML, and config files.

---

## ‚ö° Quick Start

### Installation

```bash
# Save the script to your project
curl -O https://raw.githubusercontent.com/aashiqoffortune-hash/RepoCleaner-v3/main/repo_cleaner.py
# Or download and place manually
chmod +x repo_cleaner.py
```

**Requirements**: Python 3.8 or higher. No additional packages needed.

### Basic Usage

Run from your project root:

```bash
# Preview changes without modifying files
python3 repo_cleaner.py --dry-run --verbose

# Apply cleaning
python3 repo_cleaner.py --mutate --backup
```

---

## üîß Features

### 1. **Dry-Run Preview**
See what will be removed without touching your files:

```bash
python3 repo_cleaner.py --dry-run --verbose
```

**Example Output:**
```
Initializing on /your-project...
Scanning for Lovable references...
--- DRY-RUN: 12 references across 2,340 files ---
File index.html: 3 references removed
File package.json: 1 reference removed
File src/App.tsx: 2 references removed
...
Estimated file size reduction: 15.2 KB
```

### 2. **Safe Cleaning with Backups**
```bash
python3 repo_cleaner.py --mutate --backup --verbose
```

- `--backup`: Creates timestamped ZIP of original files
- `--mutate`: Adds subtle neutral tweaks (10% chance per file) for natural appearance
- `--verbose`: Detailed progress reporting

### 3. **Git Integration**
```bash
python3 repo_cleaner.py --commit --push
```

- `--commit`: Auto-creates a git commit with neutral message
- `--push`: Automatically pushes to remote
- Messages appear like routine refactoring: `"refactor: cleanup (742)"`

### 4. **Bundle & Export**
```bash
python3 repo_cleaner.py --bundle --new-dir clean_export
```

- `--bundle`: Zips cleaned repo as `project_clean_TIMESTAMP.zip`
- `--new-dir`: Exports to specified directory instead of modifying in-place

### 5. **Logging & Diagnostics**
```bash
python3 repo_cleaner.py --log-file report.json --eta
```

- `--log-file`: JSON report of all changes
- `--eta`: Shows time estimate before starting
- `--daemon`: Run as background process

---

## üìã Complete Command Reference

```bash
python3 repo_cleaner.py [OPTIONS] [PATH]

OPTIONS:
  --dry-run              Preview changes without modifying files
  --mutate               Add subtle neutral tweaks for natural appearance
  --backup               Create timestamped backup ZIP
  --commit               Auto-create git commit
  --push                 Auto-push to remote after commit
  --bundle               Create ZIP of cleaned repo
  --new-dir DIR          Export to directory instead of in-place
  --verbose              Detailed progress output
  --log-file FILE        Write JSON report of changes
  --eta                  Show time estimate
  --daemon               Run as background process
  --obfuscate            Obfuscate remaining tool references
  --help, -h             Show help message

EXAMPLES:
  # Preview what will be removed
  python3 repo_cleaner.py . --dry-run --verbose
  
  # Clean with backup and git commit
  python3 repo_cleaner.py /path/to/repo --mutate --backup --commit
  
  # Export clean version to new directory
  python3 repo_cleaner.py . --bundle --new-dir ./clean-export
  
  # Full audit trail
  python3 repo_cleaner.py . --verbose --log-file audit.json --dry-run
```

---

## ‚úÖ What Gets Removed

RepoCleaner detects and removes:

- ‚úì "Generated by Lovable" comments
- ‚úì Lovable badge IDs and classes
- ‚úì SVG/PNG image references to Lovable
- ‚úì Tool-specific metadata in JSON
- ‚úì Watermarks in code comments
- ‚úì Framework-specific hooks (useLovableEdit, etc.)
- ‚úì Any powered-by or made-with references

**And preserves:**
- ‚úì All functional code and logic
- ‚úì CSS styling and structure
- ‚úì Configuration values
- ‚úì Project structure and assets

---

## üõ°Ô∏è Safety Features

- **Dry-run mode** to preview changes first
- **Automatic backups** before modifications
- **Git integration** for version control
- **File encoding detection** to prevent corruption
- **Binary file detection** to skip non-text files
- **Rollback capability** via git history

---

## üìä Performance

- **Small projects** (< 1K files): < 5 seconds
- **Medium projects** (1-10K files): 10-30 seconds
- **Large monorepos** (40K+ files): 2-5 minutes

All operations are single-threaded but optimized for I/O efficiency.

---

## üêõ Troubleshooting

### "Permission denied" error
```bash
chmod +x repo_cleaner.py
```

### Nothing found to clean
The script only processes known file types. Check that:
- Your files have proper extensions (.html, .js, .json, etc.)
- Lovable references aren't in binary or compressed files
- Use `--verbose` to see all scanned files

### Git commit fails
Ensure:
- You're in a git repository (`git init` if needed)
- Git is configured: `git config user.name` and `git config user.email`
- Repository has changes to commit

---

## üí° Use Cases

- **Export Cleanup**: Remove tool traces from AI-generated or template-based projects
- **Production Deploy**: Strip watermarks before publishing
- **Open Sourcing**: Clean up all tool references before releasing publicly
- **Migration**: Move away from a tool platform cleanly
- **Archive**: Preserve clean versions of project exports

---

## üìÑ License

MIT License ‚Äî Use freely in personal and commercial projects.

---

## ü§ù Contributing

Found a bug or have a suggestion? Issues and PRs welcome!

---

**Made with ‚ù§Ô∏è for developers who want clean code exports.**
- `--verbose`: Progress every 500 files + per-file details.
- `--new-dir clean_fork`: Cleans into `./clean_fork` (original safe).
- `--eta`: Runtime estimates/summary.
- `--log-file purge_log.json`: JSON export of changes.

**Output Example:**

```
Initializing on /your-project...
Scanning for Lovable references...
‚úì Backup: your-project_backup_20251218_143022_4567.zip
  - Progress: 600/1,200 (50.0%) ETA: 0m 15s
‚úì Cleaned README.md (2 refs)
  - Hit in README.md (pre: 1,250 chars)
  - Post: 1,205 chars (delta: 45)
...
‚úì Committed: refactor: cleanup optimizations (742)
  - Git staged and pushed
‚úì Cloned to: clean_fork
‚úì Bundled: clean_fork_clean_742.zip
--- COMPLETE: 3 references removed across 1,200 files. Time: 45.2s ---
  - Summary: 1,200 files, 3 matches culled.
Log saved: purge_log.json
```

### 3. Advanced

- **Subfolder**: `--path ./src` (scan `./src` only).
- **Batch**: Use `horde_purge.sh` (chmod +x): `./horde_purge.sh` for multiple folders.
- **Minimal**: `python3 repo_cleaner.py --dry-run --path .` for quick scans.

## Tips

- **Test**: Dry-run on a clone (`git clone . test-clone; cd test-clone`).
- **Undo**: Unzip backup + `git reset --hard HEAD~1`.
- **Speed**: For large repos, the sentinel skips if clean.